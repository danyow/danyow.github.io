<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-Unity@2022.1 plugin-docs plugin-id-default docs-doc-id-unity/uitoolkits/uielements/uie-getting-started/Creating your first runtime UI">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Danyow RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Danyow Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Danyow JSON Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-141789564-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-141789564-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Danyow" href="/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/changelog/rss.xml" title="日志 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/changelog/atom.xml" title="日志 Atom Feed">
<link rel="alternate" type="application/json" href="/changelog/feed.json" title="日志 JSON Feed">
<link rel="icon" href="/img/logo.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/logo.png">
<link rel="mask-icon" href="/img/logo.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/logo.png">
<meta name="msapplication-TileColor" content="#000">
<link rel="stylesheet" href="/katex/katex.min.css"><title data-rh="true">Creating your first runtime UI | Danyow</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://danyow.github.io/docs/uitoolkits/uielements/uie-getting-started/uie-how-to-create-runtime-ui"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="Unity@2022.1"><meta data-rh="true" name="docusaurus_tag" content="docs-default-Unity@2022.1"><meta data-rh="true" name="docsearch:version" content="Unity@2022.1"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-Unity@2022.1"><meta data-rh="true" property="og:title" content="Creating your first runtime UI | Danyow"><meta data-rh="true" name="description" content="This page will guide you through the steps to set up a simple character selection screen using UI Toolkit. It covers the creation of the UI elements and templates, the scene setup, and how to connect scripting logic to the UI. This guide won’t cover styling through USS, and use only default styles and theming."><meta data-rh="true" property="og:description" content="This page will guide you through the steps to set up a simple character selection screen using UI Toolkit. It covers the creation of the UI elements and templates, the scene setup, and how to connect scripting logic to the UI. This guide won’t cover styling through USS, and use only default styles and theming."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://danyow.github.io/docs/uitoolkits/uielements/uie-getting-started/uie-how-to-create-runtime-ui"><link data-rh="true" rel="alternate" href="https://danyow.github.io/docs/uitoolkits/uielements/uie-getting-started/uie-how-to-create-runtime-ui" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://danyow.github.io/en/docs/uitoolkits/uielements/uie-getting-started/uie-how-to-create-runtime-ui" hreflang="en"><link data-rh="true" rel="alternate" href="https://danyow.github.io/docs/uitoolkits/uielements/uie-getting-started/uie-how-to-create-runtime-ui" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://S3KRFC060Q-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.bff76bc0.css">
<link rel="preload" href="/assets/js/runtime~main.4e562e6e.js" as="script">
<link rel="preload" href="/assets/js/main.9af7a4d9.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_BxGa">跳到主要内容</a></div><div class="announcementBar_yyVl" role="banner"><div class="announcementBarPlaceholder_Il1w"></div><div class="announcementBarContent_KFU1">⭐️ If you like, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/danyow/danyow.github.io">GitHub</a> </div><button type="button" class="clean-btn close announcementBarClose_axA0" aria-label="关闭"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_FcXi"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Danyow Logo" class="themedImage_aIr_ themedImage--light_DGIu" height="32" width="32"><img src="/img/logo-dark.svg" alt="Danyow Logo" class="themedImage_aIr_ themedImage--dark_RoHN" height="32" width="32"></div><b class="navbar__title">Danyow</b></a><a class="navbar__item navbar__link" href="/blog">博客</a><a class="navbar__item navbar__link" href="/changelog">日志</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/animation-section/animation-section">Unity@2022.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next">v0 🚧</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/uitoolkits/uielements/uie-getting-started/uie-how-to-create-runtime-ui">Unity@2022.1</a></li><li><a href="https://62455b8ed3daac0779429a1c--danyow.netlify.app/docs/lua/hello" target="_blank" rel="noopener noreferrer" class="dropdown__link">Lua@5.3<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a class="dropdown__link" href="/versions">所有版本</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_NpMu"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>中文</span></span></a><ul class="dropdown__menu"><li><a href="/docs/uitoolkits/uielements/uie-getting-started/uie-how-to-create-runtime-ui" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">中文</a></li><li><a href="/en/docs/uitoolkits/uielements/uie-getting-started/uie-how-to-create-runtime-ui" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="https://github.com/danyow/danyow.github.io/issues/3526" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help Us Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/danyow/danyow.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_IT2h colorModeToggle_o_qc"><button class="clean-btn toggleButton_pGki toggleButtonDisabled_vZLo" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_dYsV"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_WRF1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_lGmL"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_zNSk"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_ecpa" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_NEdF"><div class="sidebar_Uz2u sidebarWithHideableNavbar_MFe1"><a tabindex="-1" class="sidebarLogo_iqfm" href="/"><img src="/img/logo.svg" alt="Danyow Logo" class="themedImage_aIr_ themedImage--light_DGIu" height="32" width="32"><img src="/img/logo-dark.svg" alt="Danyow Logo" class="themedImage_aIr_ themedImage--dark_RoHN" height="32" width="32"><b>Danyow</b></a><nav class="menu thin-scrollbar menu_XU2j menuWithAnnouncementBar_vo3y"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/animation-section/animation-section">动画</a><button aria-label="打开/收起侧边栏菜单「动画」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/asset-store/asset-store">Unity Asset Store</a><button aria-label="打开/收起侧边栏菜单「Unity Asset Store」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/asset-workflow/asset-workflow">资源工作流程</a><button aria-label="打开/收起侧边栏菜单「资源工作流程」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/audio/audio">音频</a><button aria-label="打开/收起侧边栏菜单「音频」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/creating-environments/creating-environments">World building</a><button aria-label="打开/收起侧边栏菜单「World building」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/glossary">术语表</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/graphics/graphics">图形</a><button aria-label="打开/收起侧边栏菜单「图形」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/input/input">输入</a><button aria-label="打开/收起侧边栏菜单「输入」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/legacy-topics/legacy-topics">旧版主题</a><button aria-label="打开/收起侧边栏菜单「旧版主题」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/navigation/navigation">导航和寻路</a><button aria-label="打开/收起侧边栏菜单「导航和寻路」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/open-source-repositories/open-source-repositories">开源代码仓库</a><button aria-label="打开/收起侧边栏菜单「开源代码仓库」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/packages-list/packages-list">Packages and feature sets</a><button aria-label="打开/收起侧边栏菜单「Packages and feature sets」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/physics-section/physics-section">物理系统</a><button aria-label="打开/收起侧边栏菜单「物理系统」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/platform-specific/platform-specific">平台开发</a><button aria-label="打开/收起侧边栏菜单「平台开发」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/scripting-section/scripting-section">脚本</a><button aria-label="打开/收起侧边栏菜单「脚本」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/search-overview/search-overview">Unity Search</a><button aria-label="打开/收起侧边栏菜单「Unity Search」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/uitoolkits/uitoolkits">创建用户界面 (UI)</a><button aria-label="打开/收起侧边栏菜单「创建用户界面 (UI)」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/uitoolkits/com-unity-ugui/com-unity-ugui">Unity UI</a><button aria-label="打开/收起侧边栏菜单「Unity UI」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/uitoolkits/guiscripting-guide/guiscripting-guide">即时模式 GUI (IMGUI)</a><button aria-label="打开/收起侧边栏菜单「即时模式 GUI (IMGUI)」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/uitoolkits/ui-system-compare">Unity 中 UI 系统的对比</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/uitoolkits/uielements/uielements">UI 工具包</a><button aria-label="打开/收起侧边栏菜单「UI 工具包」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/uitoolkits/uielements/uibuilder/uibuilder">UI Builder</a><button aria-label="打开/收起侧边栏菜单「UI Builder」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/uitoolkits/uielements/uie-binding">绑定</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/uitoolkits/uielements/uie-controls/uie-controls">控件</a><button aria-label="打开/收起侧边栏菜单「控件」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/uitoolkits/uielements/uie-events/uie-events">Event system</a><button aria-label="打开/收起侧边栏菜单「Event system」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/uitoolkits/uielements/uie-examples/uie-examples">Examples</a><button aria-label="打开/收起侧边栏菜单「Examples」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/uitoolkits/uielements/uie-getting-started/uie-getting-started">Get started with UI Toolkit</a><button aria-label="打开/收起侧边栏菜单「Get started with UI Toolkit」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/uitoolkits/uielements/uie-getting-started/uie-how-to-create-custom-inspector">Create a Custom Inspector</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/uitoolkits/uielements/uie-getting-started/uie-how-to-create-runtime-ui">Creating your first runtime UI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/uitoolkits/uielements/uie-getting-started/uie-simple-ui-toolkit-workflow">Simple UI Toolkit workflow</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/uitoolkits/uielements/uie-imgui">IMGUI support</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/uitoolkits/uielements/uie-layout-engine">布局引擎</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/uitoolkits/uielements/uie-migration-guides/uie-migration-guides">Migration guides</a><button aria-label="打开/收起侧边栏菜单「Migration guides」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/uitoolkits/uielements/uie-uss/uie-uss">Unity 样式表 (USS)</a><button aria-label="打开/收起侧边栏菜单「Unity 样式表 (USS)」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/uitoolkits/uielements/uie-uxml/uie-uxml">UXML 格式</a><button aria-label="打开/收起侧边栏菜单「UXML 格式」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/uitoolkits/uielements/uie-view-data">ViewData 持久性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/uitoolkits/uielements/uie-visual-tree">视觉树</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/unet/unet">多玩家和联网</a><button aria-label="打开/收起侧边栏菜单「多玩家和联网」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/unity-manual/unity-manual">Unity User Manual 2022.1 (beta)</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/unity-overview/unity-overview">在 Unity 中操作</a><button aria-label="打开/收起侧边栏菜单「在 Unity 中操作」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/unity-services/unity-services">Unity 服务</a><button aria-label="打开/收起侧边栏菜单「Unity 服务」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/unity2d/unity2d">2D</a><button aria-label="打开/收起侧边栏菜单「2D」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/video-player/video-player">视频概述</a><button aria-label="打开/收起侧边栏菜单「视频概述」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/xr/xr">XR</a><button aria-label="打开/收起侧边栏菜单「XR」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_Essf"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_bqna"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_vJqy"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_ygLL"><div class="docItemContainer_yJzi"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_nmcO" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/uitoolkits/uitoolkits"><span itemprop="name">创建用户界面 (UI)</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/uitoolkits/uielements/uielements"><span itemprop="name">UI 工具包</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/uitoolkits/uielements/uie-getting-started/uie-getting-started"><span itemprop="name">Get started with UI Toolkit</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">Creating your first runtime UI</span><meta itemprop="position" content="4"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">版本：Unity@2022.1</span><div class="tocCollapsible_aX8Q theme-doc-toc-mobile tocMobile_By44"><button type="button" class="clean-btn tocCollapsibleButton_Va7b">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>Creating your first runtime UI</h1><p>This page will guide you through the steps to set up a simple character selection screen using UI Toolkit. It covers the creation of the UI elements and templates, the scene setup, and how to connect scripting logic to the UI. This guide won’t cover styling through USS, and use only default styles and theming.</p><p>您可以在本页底部<a href="#%E6%AD%A4%E5%A4%84">此处</a>找到本指南的最终源代码。</p><p> <strong>Topics covered:</strong>  UI Builder, <a href="https://docs.unity3d.com/cn/2022.1/ScriptReference/UIElements.ListView.html" target="_blank" rel="noopener noreferrer">ListView</a>, <a href="https://docs.unity3d.com/cn/2022.1/ScriptReference/UIElements.Label.html" target="_blank" rel="noopener noreferrer">Label</a>, <a href="https://docs.unity3d.com/cn/2022.1/ScriptReference/UIElements.PanelSettings.html" target="_blank" rel="noopener noreferrer">PanelSettings</a>, <a href="https://docs.unity3d.com/cn/2022.1/ScriptReference/UIElements.UIDocument.html" target="_blank" rel="noopener noreferrer">UIDocument</a>, selection handling</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-finalMainView.png" alt="uie-howto-runtimeUI-finalMainView.png" class="img_PFMr"></p><p>本指南将指导您完成以下步骤：</p><ul><li>Create the main UI view</li><li>Setup the scene</li><li>Create sample data to display</li><li>Create a controller for the main view</li><li>Create a list entry UI template</li><li>Create a controller for a list entry</li><li>React to user selection</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="create-the-main-ui-view">Create the main UI view<a class="hash-link" href="#create-the-main-ui-view" title="标题的直接链接">​</a></h2><p>The final UI screen is composed of two individual UI templates (UXML). The main view template contains the list with the character names, a smaller panel to display the selected character’s details, and a button. In this section you will set up this template using UI Builder.</p><table><thead><tr><th><strong>Note</strong></th></tr></thead><tbody><tr><td>If you are familiar with UI Builder and want to skip this step, you can copy the UXML code for the <a href="#here"> <strong>main view</strong> </a> from the bottom of this page and paste it into a new file directly. Save it as  <strong>Assets/UI/MainView.uxml</strong> .</td></tr></tbody></table><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-mainView.png" alt="The UI layout setup for the main view" class="img_PFMr"></p><p>The UI layout setup for the main view</p><p>Open the UI Builder window via the menu  <strong>Window <!-- -->&gt;<!-- --> UI Toolkit <!-- -->&gt;<!-- --> UI Builder</strong> . Create a new UXML document using the file menu at the top left of the viewport.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-fileMenu.png" alt="UI Builder file menu" class="img_PFMr"></p><p>UI Builder file menu</p><p>When developing game UI, always make sure to select the <code>Unity Default Runtime Theme</code> at the top right of the UI Builder’s viewport. Default font sizes and colors differ between Editor and Runtime themes and that affects your layout.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-UIBuilderTheme.png" alt="Create new elements by dragging from the Library" class="img_PFMr"></p><p>Create new elements by dragging from the Library</p><p>Select the new UXML file in the  <strong>Hierarchy</strong>  and enable the  <strong>Match Game View</strong>  checkbox. You might need to set your Unity Editor to a landscape resolution if you haven’t already.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-matchGameView.png" alt="Enabling Match Game View" class="img_PFMr"></p><p>Enabling Match Game View</p><p>Now it’s time to create UI elements! Create a new VisualElement by dragging it from the  <strong>Library</strong>  into the  <strong>Hierarchy</strong> .</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-newVisualElement.png" alt="Create new elements by dragging from the Library" class="img_PFMr"></p><p>Create new elements by dragging from the Library</p><p>The new element needs to cover the entire screen, so you need to set the <code>flex-grow</code> property to 1. Select the element from the hierarchy and find the foldout labeled  <strong>Flex</strong>  in the Inspector panel on the right. Change the value for  <strong>Grow</strong>  from 0 to 1.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-flexGrow.png" alt="Setting the Flex property" class="img_PFMr"></p><p>Setting the Flex property</p><p>To center all children of this VisualElement in the middle of the screen, change the  <strong>Align</strong>  properties of the VisualElement. You need to set both  <strong>Align Items</strong>  and  <strong>Justify Content</strong>  to <em>center</em>.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-alignCenter.png" alt="Centering children" class="img_PFMr"></p><p>Centering children</p><p>Lastly, you can pick a background color under  <strong>Background <!-- -->&gt;<!-- --> Color</strong> . This step is optional. This example uses <code>#732526</code> as the color.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-backgroundColor.png" alt="Root element background color" class="img_PFMr"></p><p>Root element background color</p><p>Next, create a new VisualElement underneath the existing one. This will become the parent container for the left and right sections of the UI.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-secondaryContainer.png" alt="Add a child VisualElement" class="img_PFMr"></p><p>Add a child VisualElement</p><p>Set the <code>flex-direction</code> property to <code>row</code> for this new element (it defaults to column). You also need to set a fixed height of 350 pixels.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-centerContainer.png" alt="Center container properties" class="img_PFMr"></p><p>Center container properties</p><p>This is what the current UI should look like. Note that your screen might look different depending on the resolution and aspect ratio of your  <strong>Game View</strong> .</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-intermediate01.png" alt="Background container with empty element inside" class="img_PFMr"></p><p>Background container with empty element inside</p><p>To create the list for the character names, select a  <strong>ListView</strong>  control from the  <strong>Library</strong>  and add it as a child underneath the VisualElement you just created. Select the element and assign it the name <code>CharacterList</code> in the inspector. This is necessary so you can access this list via the controller script later.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-setElementName.png" alt="Background container with empty element inside" class="img_PFMr"></p><p>Background container with empty element inside</p><p>Set the list to have a fixed width of 230 pixels. Also give it a 6 px wide margin on the right, to crate some distance to the next elements that you are going to create.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-sizeAndMargin.png" alt="Size and Margin foldouts for the character list" class="img_PFMr"></p><p>Size and Margin foldouts for the character list</p><p>You can also assign a background color and set a rounded border for the list. This guide uses <code>#6E3925</code> for the background and <code>#311A11</code> for the border color, with a 4px wide border and a 15px radius. This step is optional.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-characterListStyling.png" alt="Styled character list" class="img_PFMr"></p><p>Styled character list</p><p>Add a new VisualElement under the same parent as the <code>CharacterList</code>. This will hold the character details panel and the button. Under the  <strong>Align</strong>  foldout, change the setting for  <strong>Align Items</strong>  to <code>flex-end</code>, and  <strong>Justify Content</strong>  to <code>space-between</code>.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-justifySpaceBetween.png" alt="Justify content property" class="img_PFMr"></p><p>Justify content property</p><p>Add a new VisualElement to this new container. This will become the character details panel. When the user selects a character from the list on the left, it will display the character’s portrait, name, and class.</p><p>Set a fixed width of 276 pixels for the element, and switch  <strong>Align Items</strong>  and  <strong>Justify Content</strong>  to <em>center</em>. Also add an 8 pixels wide padding for the element, so that the children will keep a minimum distance to the borders of the container.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-characterDetailsProperties.png" alt="Properties of the charcter details container" class="img_PFMr"></p><p>Properties of the charcter details container</p><p>You can style the panel by setting a background color of <code>#AA5939</code> and a border color of <code>#311A11</code> with a 4px wide border and a 15px radius. This step is optional.</p><p>Your UI layout should now look similar to the image below.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-intermediate02.png" alt="Empty character details panel" class="img_PFMr"></p><p>Empty character details panel</p><p>Next you’ll add the individual UI controls to the character details. First is the character portrait. This consists of two elements - a frame in the background and an image in the foreground.</p><p>Add a new VisualElement to the character details container for the background frame first. Assign it a fixed size of 120×120 pixels, and a padding of 4 pixels so that the contained image won’t directly touch the border.</p><p>You can use a 2px-wide, 15px radius border with a color of <code>#311A11</code> and a background color of <code>#FF8554</code> to style the element. Feel free to apply your own colors and styling instead.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-pictureFrame.png" alt="Background frame for the character portrait" class="img_PFMr"></p><p>Background frame for the character portrait</p><p>For the actual image add a new VisualElement as a child to the frame you just created. Name it <code>CharacterPortrait</code> so that you can access it in the controller script later.</p><p>Set  <strong>Flex <!-- -->&gt;<!-- --> Grow</strong>  to 1, so that the image makes use of all the available space. Also make sure to change the scaling mode under  <strong>Background <!-- -->&gt;<!-- --> Scale Mode</strong>  to <code>scale-to-fit</code>, so that you can scale the image to match the element size, while keeping the correct aspect ratio.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-portraitElement.png" alt="VisualElement for the portrait image" class="img_PFMr"></p><p>VisualElement for the portrait image</p><p>Next, add two label controls to the the character details container, which you will later use to display the selected character’s name and class. Name them <code>CharacterName</code> and <code>CharacterClass</code>.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-characterLabels.png" alt="Add labels for name and class" class="img_PFMr"></p><p>Add labels for name and class</p><p>To make the character’s name stand out more than the class, change that label’s font size to 18, and set the style to <em>bold</em>.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-labelSettings.png" alt="Change font settings" class="img_PFMr"></p><p>Change font settings</p><p>Your UI screen should now look similar to the image below.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-intermediate03.png" alt="Finished character details panel" class="img_PFMr"></p><p>Finished character details panel</p><p>Lastly, add a Button control to the right side UI container. You will later access this button in the controller script and enable or disable it when a character is selected or deselected. Name the button <code>SelectCharButton</code> and give it a fixed width of 150px. You should also set the label text of the button to <code>Select Character</code>.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-selectButton.png" alt="Add button for character selection" class="img_PFMr"></p><p>Add button for character selection</p><p>To style the button, set a background color of <code>#FF8554</code>, and a 2px border with a color of <code>#311A11</code>. This step is optional.</p><p>Your finished main view should look similar to the image below.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-finalMainView.png" alt="Final main view layout" class="img_PFMr"></p><p>Final main view layout</p><p>Save the UXML template as  <strong>Assets/UI/MainView.uxml</strong> . You can also find the final UXML code for this template at the bottom of the page <a href="#here">here</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="setup-the-scene">Setup the scene<a class="hash-link" href="#setup-the-scene" title="标题的直接链接">​</a></h2><p>In this section you will learn how to load and display the UI template you created in the previous section in your game at runtime.</p><p>To start you need to create a <a href="https://docs.unity3d.com/cn/2022.1/ScriptReference/UIElements.PanelSettings.html" target="_blank" rel="noopener noreferrer">PanelSettings</a> asset. This asset will define the settings of your screen, such as scaling mode and rendering order. It will also determine the name under which your UI will appear in the UI Toolkit Debugger.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-newPanelSettings.png" alt="Create a new panel settings asset" class="img_PFMr"></p><p>Create a new panel settings asset</p><p>Create a new <code>Panel Settings Asset</code> by right-clicking in the project view. Choose  <strong>Create <!-- -->&gt;<!-- --> UI Toolkit <!-- -->&gt;<!-- --> Panel Settings Asset</strong> . Name the newly created file <code>GameUI_Panel</code>. For this guide you can leave all settings at their default values.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-PanelSettingsDefaults.png" alt="No need to change the default PanelSettings" class="img_PFMr"></p><p>No need to change the default PanelSettings</p><p>To display the main view UI template from the previous section you need to create a new GameObject in the scene. Attach a <a href="https://docs.unity3d.com/cn/2022.1/ScriptReference/UIElements.UIDocument.html" target="_blank" rel="noopener noreferrer">UIDocument</a> component to it.</p><p>The <code>UIDocument</code> will automatically load the assigned <code>VisualTreeAsset</code> when entering Play mode in Unity. A <code>VisualTreeAsset</code> is a UXML template. Assign both the <code>MainView.uxml</code> and the new <code>GameUI_Panel</code> panel settings to the component.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-UIDocument.png" alt="The UI Document component" class="img_PFMr"></p><p>The UI Document component</p><table><thead><tr><th><strong>Note</strong></th></tr></thead><tbody><tr><td>If you do not assign a <code>PanelSettings</code> asset to your UI Document component, it will automatically search the project and use the first Panel Settings Asset it finds automatically. Keep this in mind when renaming or moving assets.</td></tr></tbody></table><p>You can now enter Play mode in the Unity Editor and see your UI displayed in the game view.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-playModeFirstLook.png" alt="UI displayed at runtime" class="img_PFMr"></p><p>UI displayed at runtime</p><table><thead><tr><th><strong>Note</strong></th></tr></thead><tbody><tr><td>If you have multiple UI Documents in your scene, you can assign the same panel settings asset to all. This will cause all UI to be rendered on the same panel, optimizing performance.</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="create-sample-data-to-display">Create sample data to display<a class="hash-link" href="#create-sample-data-to-display" title="标题的直接链接">​</a></h2><p>In this section you will create some sample data that will be used to fill the character list in the UI with data.</p><p>For the character list you need a simple class that holds a character name, class, and a portrait image. Create a new ScriptableObject script  <strong>Assets/Scripts/CharacterData.cs</strong>  and paste the following code into the file:</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public enum ECharacterClass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Knight, Ranger, Wizard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CreateAssetMenu]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CharacterData : ScriptableObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public string m_CharacterName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public ECharacterClass m_Class;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public Sprite m_PortraitImage;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>The <code>[CreateAssetMenu]</code> attribute will automatically add an entry to the  <strong>Create</strong>  menu. Right-click into a folder in the Project view to create instances of the new ScriptableObject.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-createCharacterData.png" alt="New Create menu entry" class="img_PFMr"></p><p>New Create menu entry</p><p>Now you need to create a few <code>CharacterData</code> instances and fill them with random data. Place all of them in a folder  <strong>Resources/Characters</strong> . You will write a script which automatically parses and loads all character data from this folder later.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-characterDataProperties.png" alt="Create a few sample characters" class="img_PFMr"></p><p>Create a few sample characters</p><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="create-a-list-entry-ui-template">Create a list entry UI template<a class="hash-link" href="#create-a-list-entry-ui-template" title="标题的直接链接">​</a></h2><p>In this section you will create a UI template for the individual entries in the list. At runtime, a controller script will create an instance of this UI for each character and add it to the list. The UI for a character list entry consists of acolored background frame and the character name.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-listEntryFinal.png" alt="List entry showing the character name" class="img_PFMr"></p><p>List entry showing the character name</p><table><thead><tr><th><strong>Note</strong></th></tr></thead><tbody><tr><td>If you want to skip this step, you can copy the UXML code for the <a href="#here"> <strong>list entry</strong> </a> from the bottom of this page and paste it into a new file directly. Save it as  <strong>Assets/UI/ListEntry.uxml</strong> .</td></tr></tbody></table><p>Open the UI Builder window via the menu  <strong>Window <!-- -->&gt;<!-- --> UI Toolkit <!-- -->&gt;<!-- --> UI Builder</strong> . Create a new UXML template by selecting  <strong>File <!-- -->&gt;<!-- --> New</strong> .</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-fileMenu.png" alt="Create a new UXML template in UI Builder" class="img_PFMr"></p><p>Create a new UXML template in UI Builder</p><p>Add a VisualElement for the background, and set a fixed heigth of 41px. Since the text inside the entry should be left aligned and placed in the middle of the element, open the  <strong>Align</strong>  foldout and set  <strong>Align Items</strong>  to <em>left</em>, and  <strong>Justify Content</strong>  to <em>center</em>. Also set a left padding of 10px, to make the label have a minimum distance to the left border of the frame.</p><p>For the styling, you can use <code>#AA5939</code> for the background color and add a 2px wide border, with a 15px radius and a color of <code>#311A11</code>. This step is optional and you can apply your own colors and styling.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-listEntryBackground.png" alt="The background VisualElement" class="img_PFMr"></p><p>The background VisualElement</p><p>Add a label as a child to the existing VisualElement and name it <code>CharacterName</code>, so that you can access it later in the controller script. Set the  <strong>Font Style</strong>  to <em>bold</em> and the font size to 18.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-listEntryLabel.png" alt="Add label for the characters name" class="img_PFMr"></p><p>Add label for the character’s name</p><p>Save the UXML template as  <strong>Assets/UI/ListEntry.uxml</strong> . You can also find the final UXML code for this template at the bottom of the page <a href="#here">here</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="create-a-controller-for-a-list-entry">Create a controller for a list entry<a class="hash-link" href="#create-a-controller-for-a-list-entry" title="标题的直接链接">​</a></h2><p>In this section you will create a controller script for a list entry. The purpose of the script is to display the data of a character instance in the UI of the list entry. It needs to access the label for the character name and set it to display the name of the given character instance.</p><p>Create a new script  <strong>Assets/Scripts/UI/CharacterListEntryController.cs</strong>  and paste the following code into it:</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine.UIElements;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CharacterListEntryController</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private Label m_NameLabel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public void SetVisualElement(VisualElement rootEleme)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_NameLabel = visualElement.Q&amp;lt;Label&amp;gt;(&quot;CharacterName&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public void SetCharacterData(CharacterData characterData)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_NameLabel.text = characterData.m_CharacterName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>There are two functions in this class, and both of them are <code>Set</code> functions.</p><p><code>SetvisualElement(VisualElement visualElement)</code> This function will receive a visual element that is an instance of the <code>ListEntry</code> UI template you created in the previous section. The main view controller will create this instance. The purpose of this function is to retrieve a reference to the character name label inside the UI element.</p><p><code>SetCharacterData(CharacterData characterData)</code> This function receives the character whose name this list element is supposed to display. Because the elements list in a <code>ListView</code> are pooled and reused, it’s necessary to have a <code>Set</code> function to change which character’s data to display.</p><p>Note that the <code>CharacterListEntry</code> class is not a <code>MonoBehaviour</code>. Since the visual elements in UI Toolkit aren’t GameObjects, you can’t attach components to them. Instead, this class will be attached to the <code>userData</code> property in the next section.</p><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="create-a-controller-for-the-main-view">Create a controller for the main view<a class="hash-link" href="#create-a-controller-for-the-main-view" title="标题的直接链接">​</a></h2><p>In this section you will create a controller script for the character list in the main view, and a MonoBehaviour script that instantiates and assignes it to the visual tree.</p><p>To start, create a new script under  <strong>Assets/Scripts/UI/CharacterListController.cs</strong>  and paste the following code into it.</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine.UIElements;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CharacterListController</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public void InitializeCharacterList(VisualElement root, VisualTreeAsset listElementTemplate)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>You’re going to fill in the <code>InitializeCharacterList()</code> method late on, but it’s important to add the empty method now, so that you can call it in the next section.</p><p> <strong>Attach the controller script to the main view</strong> </p><p>Just like the <code>CharacterListEntryController</code>, the <code>CharacterListController</code> is not a <code>MonoBehaviour</code>, and needs to be attached to the visual tree in a different manner. You need to create a MonoBehaviour script that you can attach to the same GameObject as the <code>UIDocument</code>. It will instantiate the <code>CharacterListController</code> and attach it to the Visual Tree.</p><p>Create a new script  <strong>Assets/Scripts/UI/MainView.cs</strong>  and paste the following code into it:</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine.UIElements;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MainView : MonoBehaviour</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [SerializeField] private VisualTreeAsset m_ListEntryTemplate;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void OnEnable()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // The UXML is already instantiated by the UIDocument component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var uiDocument = GetComponent&amp;lt;UIDocument&amp;gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Initialize the character list controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var characterListController = new CharacterListController();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    characterListController.InitializeCharacterList(uiDocument.rootVisualElement, m_ListEntryTemplate);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Go into the Unity Editor and attach the script to the same GameObject that the <code>UIDocument</code> is on. Assign the <code>ListEntry.uxml</code> to the  <strong>List Entry Template</strong>  property.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-assignListEntry.png" alt="Add main view script and assign reference" class="img_PFMr"></p><p>Add main view script and assign reference</p><p>There’s no need for your script component to instantiate the MainView UXML, as this is done automatically in the <code>UIDocument</code> component on the same GameObject. The <code>MainView</code> script accesses the UIDocument component to get a reference of the already instantiated Visual Tree. It then creates an instance of the <code>CharacterListController</code> and passes in the root element of the visual tree and the UXML template used for the individual list elements.</p><table><thead><tr><th><strong>Note</strong></th></tr></thead><tbody><tr><td>When the UI is reloaded, companion MonoBehaviour components on the same GameOBject containing the <code>UIDocument</code> component will be disabled prior to the reload, and then re-enabled after the reload. Therefore it’s a good practice to place code that interacts with the UI in the <code>OnEnable</code> and <code>OnDisable</code> methods of these MonoBehaviours.</td></tr></tbody></table><p> <strong>Enumerate all character data instances</strong> </p><p>The first functionality you should add to the controller script is a function that enumerates all the character data instances you created earlier. These will be used to fill the list.</p><p>Copy the code below into the <code>CharacterListController</code> class.</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">private List&amp;lt;CharacterData&amp;gt; m_AllCharacters;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private void EnumerateAllCharacters()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_AllCharacters = new List&amp;lt;CharacterData&amp;gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_AllCharacters.AddRange(Resources.LoadAll&amp;lt;CharacterData&amp;gt;(&quot;Characters&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><table><thead><tr><th><strong>Note</strong></th></tr></thead><tbody><tr><td>This code assumes that you created the character instances in the  <strong>Resources/Characters</strong>  folder. You might need to adjust the folder name accordingly if you placed the characters in a different folder.</td></tr></tbody></table><p>Now you need to call the <code>EnumerateAllCharacter</code> method during initialization. Add a call to it to the top of the <code>InitializeCharacterList</code> method:</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">public void InitializeCharacterList(VisualElement root, VisualTreeAsset listElementTemplate)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Enumerate all characters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  EnumerateAllCharacters();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p> <strong>Get references to the UI elements</strong> </p><p>In this section you will fill in the content of the <code>InitializeCharacterList</code> method. The first thing this method needs to do is obtain references to all the individual UI controls it needs to access to display information. Use the <a href="/docs/uitoolkits/uielements/uie-uxml/uie-uquery">UQuery</a> family of APIs to retrieve individual UI controls by name, USS class, type, or a combination of these.</p><p>Extend the code inside the <code>CharacterListController</code> class with the code below:</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">// UXML template for list entries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private VisualTreeAsset m_ListEntryTemplate;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// UI element references</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private ListView m_CharacterList;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private Label m_CharClassLabel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private Label m_CharNameLabel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private VisualElement m_CharPortrait;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private Button m_SelectCharButton;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public void InitializeCharacterList(VisualElement root, VisualTreeAsset listElementTemplate)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Enumerate all characters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  EnumerateAllCharacters();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Store a reference to the template for the list entries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_ListEntryTemplate = listElementTemplate;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Store a reference to the character list element</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_CharacterList = root.Q&amp;lt;ListView&amp;gt;(&quot;CharacterList&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Store references to the selected character info elements</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_CharClassLabel = root.Q&amp;lt;Label&amp;gt;(&quot;CharacterClass&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_CharNameLabel = root.Q&amp;lt;Label&amp;gt;(&quot;CharacterName&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_CharPortrait = root.Q&amp;lt;VisualElement&amp;gt;(&quot;CharacterPortrait&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Store a reference to the select button</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_SelectCharButton = root.Q&amp;lt;Button&amp;gt;(&quot;SelectCharButton&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p> <strong>Fill the list with entries</strong> </p><p>Next you need to fill the list on the screen with the characters you enumerated and loaded earlier. To do so you need to create a new method <code>FillCharacterList</code> inside the <code>CharacterListController</code> class.</p><p>Filling a <a href="https://docs.unity3d.com/cn/2022.1/ScriptReference/UIElements.ListView.html" target="_blank" rel="noopener noreferrer">ListView</a> with elements takes 4 steps:</p><ol><li>Create a <code>makeItem</code> function</li><li>Create a <code>bindItem</code> function</li><li>Set the item height</li><li>Set the item source</li></ol><p>The purpose of a <a href="https://docs.unity3d.com/cn/2022.1/Manual/UIElements.BaseVerticalCollectionView-makeItem.html" target="_blank" rel="noopener noreferrer">makeItem</a> callback function is to create a small visual tree representing the UI a single list item, and returning the root VisualElement of this tree.</p><p>In this case, the <code>makeItem</code> callback needs to instantiate the UXML template you created for the list entries. IT also needs to create an instance of the <code>CharacterListEntryController</code> controller script, which takes care of filling the UI with the data from the <code>CharacterData</code>.</p><p>Create a <code>FillCharacterList</code> method inside the class and paste the code below.</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">private void FillCharacterList()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Set up a make item function for a list entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_CharacterList.makeItem = () =&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Instantiate the UXML template for the entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var newListEntry = m_ListEntryTemplate.Instantiate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Instantiate a controller for the data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var newListEntryLogic = new CharacterListEntryController();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Assign the controller script to the visual element</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    newListEntry.userData = newListEntryLogic;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Initialize the controller script</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    newListEntryLogic.SetVisualElement(newListEntry);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Return the root of the instantiated visual tree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return newListEntry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>As part of the <code>makeItem</code> callback, you’re storing the controller script inside the <code>userData</code> property of the instantiated visual element. This allows you to access the script at a later time and assign different characters to the list element.</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">// Assign the controller script to the visual element</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">newListEntry.userData = newListEntryLogic;</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>As a memory and performance optimization, a <code>ListView</code> reuses list elements instead of instantiating one element for every entry in the list. It creates only enough visual elements to fill the visible area, and then pools and reuses them as the list is scrolled.</p><p>For this reason you need to provide a <a href="https://docs.unity3d.com/cn/2022.1/Manual/UIElements.BaseVerticalCollectionView-bindItem.html" target="_blank" rel="noopener noreferrer">bindItem</a> callback which binds an instance of your data (in this case <code>CharacterData</code>) to an individual list element.</p><p>Extend the <code>FillCharacterList</code> method by adding the code below at the bottom.</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">private void FillCharacterList()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Set up bind function for a specific list entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_CharacterList.bindItem = (item, index) =&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    (item.userData as CharacterListEntryController).SetCharacterData(m_AllCharacters[index]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>The <code>bindItem</code> callback receives a reference to the root visual element for the visual tree of the list entry, and an index for the data. Because you stored a reference to the <code>CharacterListEntryController</code> in the <code>userData</code> property of the visual element, the code can access it and directly set the <code>CharacterData</code>.</p><p>Lastly you need to set the item height of the element and provide a reference to the data source for the list. This tells the list how many elements it contains.</p><p>Extend the <code>FillCharacterList</code> method by adding the code below at the bottom.</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">private void FillCharacterList()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Set a fixed item height</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_CharacterList.fixedItemHeight = 45;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // For Unity versions earlier than 2021.2 use this:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  //m_CharacterList.itemHeight = 45;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Set the actual item&#x27;s source list/array</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_CharacterList.itemsSource = m_AllCharacters;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Finally, you need to call the <code>FillCharacterList</code> method at the end of initialization. Add a call to the bottom of the <code>InitializeCharacterList</code> method as shown below:</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">public void InitializeCharacterList(VisualElement root, VisualTreeAsset listElementTemplate)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  FillCharacterList();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>If you enter  <strong>Play Mode</strong>  now, the character list will fill up with the names of the characters you created.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-playModeListView.png" alt="The character list is no longer empty" class="img_PFMr"></p><p>The character list is no longer empty</p><p>You can find the final code for the <code>CharacterListController</code> script at the bottom of this guide,  <strong><a href="#here">here</a></strong> </p><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="react-to-user-selection">React to user selection<a class="hash-link" href="#react-to-user-selection" title="标题的直接链接">​</a></h2><p>When the user selects a character, the character’s details - namely portrait, full name and class - need to be displayed in the character details section on the right side of the screen. Also, when a character is selected, the selection button needs to be enabled. When no character is selected, the button should disable again.</p><p>Note that you can already click and select characters in your list. The functionality for selection and highlighting are part of the <a href="https://docs.unity3d.com/cn/2022.1/ScriptReference/UIElements.ListView.html" target="_blank" rel="noopener noreferrer">ListView</a> control. All you need to add is a callback function to react when a user changes the selection in the list. The <code>ListView</code> control contains an <code>onSelectionChange</code> event for this purpose:</p><p>Add the following code to the bottom of the <code>InitializeCharacterList</code> method:</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">public void InitializeCharacterList(VisualElement root, VisualTreeAsset listElementTemplate)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Register to get a callback when an item is selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_CharacterList.onSelectionChange += OnCharacterSelected;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Now you need to implement the callback function <code>OnCharacterSelected</code> that you set up in the code above. This function will receive a list of all selected items in the list. However, because you list only allows single item selection, you can access the selected item directly through the list’s <a href="https://docs.unity3d.com/cn/2022.1/Manual/UIElements.BaseVerticalCollectionView-selectedItem.html" target="_blank" rel="noopener noreferrer">selectedItem</a> property.</p><p>Copy the code below into your class:</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">private void OnCharacterSelected(IEnumerable&amp;lt;object&amp;gt; selectedItems)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Get the currently selected item directly from the ListView</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  var selectedCharacter = m_CharacterList.selectedItem as CharacterData;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>The <code>selectedItem</code> property could return null. This is the case if nothing is selected, or the user presses the <code>ESC</code> key to deselect everything. This case needs to be handled first.</p><p>Extend the <code>OnCharacterSelected</code> method as shown below:</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">private void OnCharacterSelected(IEnumerable&amp;lt;object&amp;gt; selectedItems)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Get the currently selected item directly from the ListView</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  var selectedCharacter = m_CharacterList.selectedItem as CharacterData;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Handle none-selection (Escape to deselect everything)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (selectedCharacter == null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Clear</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharClassLabel.text = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharNameLabel.text = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharPortrait.style.backgroundImage = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Disable the select button</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_SelectCharButton.SetEnabled(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>If the selection is valid, you need to display the character’s details in the UI. You can access to the labels and the portrait image visual elements via the references you retrieved in the <code>InitializeCharacterList</code> method of your class.</p><p>Copy the code below into the <code>OnCharacterSelected</code> method:</p><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">private void OnCharacterSelected(IEnumerable&amp;lt;object&amp;gt; selectedItems)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Fill in character details</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_CharClassLabel.text = selectedCharacter.m_Class.ToString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_CharNameLabel.text = selectedCharacter.m_CharacterName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_CharPortrait.style.backgroundImage = new StyleBackground(selectedCharacter.m_PortraitImage);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // Enable the select button</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  m_SelectCharButton.SetEnabled(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>You can now enter  <strong>Play Mode</strong>  and see your character selection list in action. Press the <code>Escape</code> key to deselect a character.</p><p><img loading="lazy" src="https://docs.unity3d.com/cn/2022.1/uploads/Main/uie-howto-runtimeUI-final.png" alt="Final runtime UI" class="img_PFMr"></p><p>Final runtime UI</p><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="final-scripts">Final scripts<a class="hash-link" href="#final-scripts" title="标题的直接链接">​</a></h2><p>Below you can find the full source code for all files created in this guide.</p><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="mainviewuxml">MainView.uxml<a class="hash-link" href="#mainviewuxml" title="标题的直接链接">​</a></h3><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">&amp;lt;ui:UXML xmlns:ui=&quot;UnityEngine.UIElements&quot; xmlns:uie=&quot;UnityEditor.UIElements&quot; editor-extension-mode=&quot;False&quot;&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &amp;lt;ui:VisualElement style=&quot;flex-grow: 1; align-items: center; justify-content: center; background-color: rgb(115, 37, 38);&quot;&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &amp;lt;ui:VisualElement style=&quot;flex-direction: row; height: 350px;&quot;&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &amp;lt;ui:ListView focusable=&quot;true&quot; name=&quot;CharacterList&quot; style=&quot;width: 230px; border-left-color: rgb(49, 26, 17); border-right-color: rgb(49, 26, 17); border-top-color: rgb(49, 26, 17); border-bottom-color: rgb(49, 26, 17); border-left-width: 4px; border-right-width: 4px; border-top-width: 4px; border-bottom-width: 4px; background-color: rgb(110, 57, 37); border-top-left-radius: 15px; border-bottom-left-radius: 15px; border-top-right-radius: 15px; border-bottom-right-radius: 15px; margin-right: 6px;&quot; /&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &amp;lt;ui:VisualElement style=&quot;justify-content: space-between; align-items: flex-end;&quot;&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &amp;lt;ui:VisualElement style=&quot;align-items: center; background-color: rgb(170, 89, 57); border-left-width: 4px; border-right-width: 4px; border-top-width: 4px; border-bottom-width: 4px; border-left-color: rgb(49, 26, 17); border-right-color: rgb(49, 26, 17); border-top-color: rgb(49, 26, 17); border-bottom-color: rgb(49, 26, 17); border-top-left-radius: 15px; border-bottom-left-radius: 15px; border-top-right-radius: 15px; border-bottom-right-radius: 15px; width: 276px; justify-content: center; padding-left: 8px; padding-right: 8px; padding-top: 8px; padding-bottom: 8px;&quot;&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &amp;lt;ui:VisualElement style=&quot;border-left-color: rgb(49, 26, 17); border-right-color: rgb(49, 26, 17); border-top-color: rgb(49, 26, 17); border-bottom-color: rgb(49, 26, 17); border-left-width: 2px; border-right-width: 2px; border-top-width: 2px; border-bottom-width: 2px; height: 120px; width: 120px; border-top-left-radius: 13px; border-bottom-left-radius: 13px; border-top-right-radius: 13px; border-bottom-right-radius: 13px; padding-left: 4px; padding-right: 4px; padding-top: 4px; padding-bottom: 4px; background-color: rgb(255, 133, 84);&quot;&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &amp;lt;ui:VisualElement name=&quot;CharacterPortrait&quot; style=&quot;flex-grow: 1; -unity-background-scale-mode: scale-to-fit;&quot; /&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &amp;lt;/ui:VisualElement&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &amp;lt;ui:Label text=&quot;Label&quot; name=&quot;CharacterName&quot; style=&quot;-unity-font-style: bold; font-size: 18px;&quot; /&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &amp;lt;ui:Label text=&quot;Label&quot; display-tooltip-when-elided=&quot;true&quot; name=&quot;CharacterClass&quot; style=&quot;margin-top: 2px; margin-bottom: 8px; padding-top: 0; padding-bottom: 0;&quot; /&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &amp;lt;/ui:VisualElement&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &amp;lt;ui:Button text=&quot;Select Character&quot; display-tooltip-when-elided=&quot;true&quot; name=&quot;SelectCharButton&quot; style=&quot;width: 150px; border-left-color: rgb(49, 26, 17); border-right-color: rgb(49, 26, 17); border-top-color: rgb(49, 26, 17); border-bottom-color: rgb(49, 26, 17); background-color: rgb(255, 133, 84); border-left-width: 2px; border-right-width: 2px; border-top-width: 2px; border-bottom-width: 2px;&quot; /&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &amp;lt;/ui:VisualElement&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &amp;lt;/ui:VisualElement&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &amp;lt;/ui:VisualElement&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;lt;/ui:UXML&amp;gt;</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="listentryuxml">ListEntry.uxml<a class="hash-link" href="#listentryuxml" title="标题的直接链接">​</a></h3><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">&amp;lt;ui:UXML xmlns:ui=&quot;UnityEngine.UIElements&quot; xmlns:uie=&quot;UnityEditor.UIElements&quot; editor-extension-mode=&quot;False&quot;&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &amp;lt;ui:VisualElement style=&quot;height: 41px; align-items: flex-start; justify-content: center; padding-left: 10px; background-color: rgba(170, 89, 57, 255); border-left-color: rgba(49, 26, 17, 255); border-right-color: rgba(49, 26, 17, 255); border-top-color: rgba(49, 26, 17, 255); border-bottom-color: rgba(49, 26, 17, 255); border-left-width: 2px; border-right-width: 2px; border-top-width: 2px; border-bottom-width: 2px; border-top-left-radius: 15px; border-bottom-left-radius: 15px; border-top-right-radius: 15px; border-bottom-right-radius: 15px;&quot;&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &amp;lt;ui:Label text=&quot;Label&quot; display-tooltip-when-elided=&quot;true&quot; name=&quot;CharacterName&quot; style=&quot;-unity-font-style: bold; font-size: 18px;&quot; /&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &amp;lt;/ui:VisualElement&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;lt;/ui:UXML&amp;gt;</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="characterdatacs">CharacterData.cs<a class="hash-link" href="#characterdatacs" title="标题的直接链接">​</a></h3><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public enum ECharacterClass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Knight, Ranger, Wizard</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[CreateAssetMenu]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CharacterData : ScriptableObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public string m_CharacterName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public ECharacterClass m_Class;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public Sprite m_PortraitImage;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="characterlistentrycontrollercs">CharacterListEntryController.cs<a class="hash-link" href="#characterlistentrycontrollercs" title="标题的直接链接">​</a></h3><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine.UIElements;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CharacterListEntryController</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private Label m_NameLabel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public void SetVisualElement(VisualElement visualElement)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_NameLabel = visualElement.Q&amp;lt;Label&amp;gt;(&quot;CharacterName&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public void SetCharacterData(CharacterData characterData)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_NameLabel.text = characterData.m_CharacterName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="mainviewcs">MainView.cs<a class="hash-link" href="#mainviewcs" title="标题的直接链接">​</a></h3><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine.UIElements;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MainView : MonoBehaviour</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [SerializeField] private VisualTreeAsset m_ListEntryTemplate;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  void OnEnable()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // The UXML is already instantiated by the UIDocument component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var uiDocument = GetComponent&amp;lt;UIDocument&amp;gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Initialize the character list controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var characterListController = new CharacterListController();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    characterListController.InitializeCharacterList(uiDocument.rootVisualElement, m_ListEntryTemplate);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="characterlistcontrollercs">CharacterListController.cs<a class="hash-link" href="#characterlistcontrollercs" title="标题的直接链接">​</a></h3><div class="codeBlockContainer_CBWl theme-code-block"><div class="codeBlockContent_vhl8" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-text codeBlock_w2AC thin-scrollbar"><code class="codeBlockLines_OfWd"><span class="token-line" style="color:#393A34"><span class="token plain">using System;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System.Collections.Generic;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using UnityEngine.UIElements;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CharacterListController</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private List&amp;lt;CharacterData&amp;gt; m_AllCharacters;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // UXML template for list entries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private VisualTreeAsset m_ListEntryTemplate;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // UI element references</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private ListView m_CharacterList;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private Label m_CharClassLabel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private Label m_CharNameLabel;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private VisualElement m_CharPortrait;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private Button m_SelectCharButton;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private void EnumerateAllCharacters()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_AllCharacters = new List&amp;lt;CharacterData&amp;gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_AllCharacters.AddRange(Resources.LoadAll&amp;lt;CharacterData&amp;gt;(&quot;Characters&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public void InitializeCharacterList(VisualElement root, VisualTreeAsset listElementTemplate)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Enumerate all characters</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    EnumerateAllCharacters();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Store a reference to the template for the list entries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_ListEntryTemplate = listElementTemplate;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Store a reference to the character list element</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharacterList = root.Q&amp;lt;ListView&amp;gt;(&quot;CharacterList&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Store references to the selected character info elements</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharClassLabel = root.Q&amp;lt;Label&amp;gt;(&quot;CharacterClass&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharNameLabel = root.Q&amp;lt;Label&amp;gt;(&quot;CharacterName&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharPortrait = root.Q&amp;lt;VisualElement&amp;gt;(&quot;CharacterPortrait&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Store a reference to the select button</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_SelectCharButton = root.Q&amp;lt;Button&amp;gt;(&quot;SelectCharButton&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    FillCharacterList();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Register to get a callback when an item is selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharacterList.onSelectionChange += OnCharacterSelected;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private void OnCharacterSelected(IEnumerable&amp;lt;object&amp;gt; selectedItems)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Get the currently selected item directly from the ListView</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var selectedCharacter = m_CharacterList.selectedItem as CharacterData;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Handle none-selection (Escape to deselect everything)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (selectedCharacter == null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Clear</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      m_CharClassLabel.text = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      m_CharNameLabel.text = &quot;&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      m_CharPortrait.style.backgroundImage = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Disable the select button</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      m_SelectCharButton.SetEnabled(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Fill in character details</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharClassLabel.text = selectedCharacter.m_Class.ToString();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharNameLabel.text = selectedCharacter.m_CharacterName;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharPortrait.style.backgroundImage = new StyleBackground(selectedCharacter.m_PortraitImage);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Enable the select button</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_SelectCharButton.SetEnabled(true);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private void FillCharacterList()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Set up a make item function for a list entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharacterList.makeItem = () =&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Instantiate the UXML template for the entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      var newListEntry = m_ListEntryTemplate.Instantiate();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Instantiate a controller for the data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      var newListEntryLogic = new CharacterListEntryController();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Assign the controller script to the visual element</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      newListEntry.userData = newListEntryLogic;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Initialize the controller script</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      newListEntryLogic.SetVisualElement(newListEntry);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      // Return the root of the instantiated visual tree</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return newListEntry;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Set up bind function for a specific list entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharacterList.bindItem = (item, index) =&amp;gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      (item.userData as CharacterListEntryController).SetCharacterData(m_AllCharacters[index]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Set a fixed item height</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharacterList.fixedItemHeight = 45;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // For Unity versions earlier than 2021.2 use this:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //m_CharacterList.itemHeight = 45;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // Set the actual item&#x27;s source list/array</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    m_CharacterList.itemsSource = m_AllCharacters;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="复制代码到剪贴板" title="复制" class="copyButton_R7VQ clean-btn"><span class="copyButtonIcons_Uqyx" aria-hidden="true"><svg class="copyButtonIcon_CtfL" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Mq1p" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://crowdin.com/project/docusaurus-v2/zh-Hans" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_OMbO" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vA0S"><span class="theme-last-updated">最后<!-- -->由 <b>danyow</b> <!-- -->于 <b><time datetime="2022-03-31T15:56:20.000Z">2022/3/31</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/uitoolkits/uielements/uie-getting-started/uie-how-to-create-custom-inspector"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Create a Custom Inspector</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/uitoolkits/uielements/uie-getting-started/uie-simple-ui-toolkit-workflow"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Simple UI Toolkit workflow</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_jWtb thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#create-the-main-ui-view" class="table-of-contents__link toc-highlight">Create the main UI view</a></li><li><a href="#setup-the-scene" class="table-of-contents__link toc-highlight">Setup the scene</a></li><li><a href="#create-sample-data-to-display" class="table-of-contents__link toc-highlight">Create sample data to display</a></li><li><a href="#create-a-list-entry-ui-template" class="table-of-contents__link toc-highlight">Create a list entry UI template</a></li><li><a href="#create-a-controller-for-a-list-entry" class="table-of-contents__link toc-highlight">Create a controller for a list entry</a></li><li><a href="#create-a-controller-for-the-main-view" class="table-of-contents__link toc-highlight">Create a controller for the main view</a></li><li><a href="#react-to-user-selection" class="table-of-contents__link toc-highlight">React to user selection</a></li><li><a href="#final-scripts" class="table-of-contents__link toc-highlight">Final scripts</a><ul><li><a href="#mainviewuxml" class="table-of-contents__link toc-highlight">MainView.uxml</a></li><li><a href="#listentryuxml" class="table-of-contents__link toc-highlight">ListEntry.uxml</a></li><li><a href="#characterdatacs" class="table-of-contents__link toc-highlight">CharacterData.cs</a></li><li><a href="#characterlistentrycontrollercs" class="table-of-contents__link toc-highlight">CharacterListEntryController.cs</a></li><li><a href="#mainviewcs" class="table-of-contents__link toc-highlight">MainView.cs</a></li><li><a href="#characterlistcontrollercs" class="table-of-contents__link toc-highlight">CharacterListController.cs</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.4e562e6e.js"></script>
<script src="/assets/js/main.9af7a4d9.js"></script>
</body>
</html>