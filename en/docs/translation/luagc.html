<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-translation/luagc">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/en/blog/rss.xml" title="Danyow RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/blog/atom.xml" title="Danyow Atom Feed">
<link rel="alternate" type="application/json" href="/en/blog/feed.json" title="Danyow JSON Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-141789564-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-141789564-1",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Danyow" href="/en/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/en/changelog/rss.xml" title="日志 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/changelog/atom.xml" title="日志 Atom Feed">
<link rel="alternate" type="application/json" href="/en/changelog/feed.json" title="日志 JSON Feed">
<link rel="icon" href="/en/img/logo.png">
<link rel="manifest" href="/en/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/en/img/logo.png">
<link rel="mask-icon" href="/en/img/logo.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/en/img/logo.png">
<meta name="msapplication-TileColor" content="#000">
<link rel="stylesheet" href="/katex/katex.min.css"><title data-rh="true">Lua的垃圾回收 | Danyow</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://danyow.github.io/en/docs/translation/luagc"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Lua的垃圾回收 | Danyow"><meta data-rh="true" name="description" content="Youtube视频地址"><meta data-rh="true" property="og:description" content="Youtube视频地址"><link data-rh="true" rel="icon" href="/en/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://danyow.github.io/en/docs/translation/luagc"><link data-rh="true" rel="alternate" href="https://danyow.github.io/docs/translation/luagc" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://danyow.github.io/en/docs/translation/luagc" hreflang="en"><link data-rh="true" rel="alternate" href="https://danyow.github.io/docs/translation/luagc" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://S3KRFC060Q-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/en/assets/css/styles.bff76bc0.css">
<link rel="preload" href="/en/assets/js/runtime~main.ff5b954a.js" as="script">
<link rel="preload" href="/en/assets/js/main.7d9fb09f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_BxGa">Skip to main content</a></div><div class="announcementBar_yyVl" role="banner"><div class="announcementBarPlaceholder_Il1w"></div><div class="announcementBarContent_KFU1">⭐️ <a target="_blank" rel="noopener noreferrer" href="https://github.com/danyow/danyow.github.io">如喜, 赏星</a>  ⭐️</div><button type="button" class="clean-btn close announcementBarClose_axA0" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_FcXi"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><div class="navbar__logo"><img src="/en/img/logo.svg" alt="Danyow Logo" class="themedImage_aIr_ themedImage--light_DGIu" height="32" width="32"><img src="/en/img/logo-dark.svg" alt="Danyow Logo" class="themedImage_aIr_ themedImage--dark_RoHN" height="32" width="32"></div><b class="navbar__title">Danyow</b></a><a class="navbar__item navbar__link navbar__link--active" href="/en/docs">储备</a><a class="navbar__item navbar__link" href="/en/blog">博客</a><a class="navbar__item navbar__link" href="/en/changelog">日志</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/en/docs">v0 🚧</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/en/docs/translation/luagc">v0 🚧</a></li><li><a href="https://danyow-jbufheovr-danyow.vercel.app/docs/unity-manual/unity-manual" target="_blank" rel="noopener noreferrer" class="dropdown__link">Unity@2022.1<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://danyow-n1bljgzah-danyow.vercel.app/docs/lua/hello" target="_blank" rel="noopener noreferrer" class="dropdown__link">Lua@5.3<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a class="dropdown__link" href="/en/versions">所有版本</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_NpMu"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/docs/translation/luagc" target="_self" rel="noopener noreferrer" class="dropdown__link">中文</a></li><li><a href="/en/docs/translation/luagc" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="https://github.com/danyow/danyow.github.io/issues/3526" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help Us Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_GWqj"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/danyow/danyow.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_IT2h colorModeToggle_o_qc"><button class="clean-btn toggleButton_pGki toggleButtonDisabled_vZLo" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_dYsV"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_WRF1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_lGmL"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_zNSk"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_ecpa" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_NEdF"><div class="sidebar_Uz2u sidebarWithHideableNavbar_MFe1"><a tabindex="-1" class="sidebarLogo_iqfm" href="/en/"><img src="/en/img/logo.svg" alt="Danyow Logo" class="themedImage_aIr_ themedImage--light_DGIu" height="32" width="32"><img src="/en/img/logo-dark.svg" alt="Danyow Logo" class="themedImage_aIr_ themedImage--dark_RoHN" height="32" width="32"><b>Danyow</b></a><nav class="menu thin-scrollbar menu_XU2j menuWithAnnouncementBar_vo3y"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/en/docs/audition">八股</a><button aria-label="Toggle the collapsible sidebar category &#x27;八股&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs/glossary">术语表</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/en/docs">占位符</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/en/docs/reprint">转载</a><button aria-label="Toggle the collapsible sidebar category &#x27;转载&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/en/docs/translation">翻译</a><button aria-label="Toggle the collapsible sidebar category &#x27;翻译&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/en/docs/translation/boehm">Boehm垃圾回收</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/en/docs/translation/luagc">Lua的垃圾回收</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_Essf"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_bqna"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_vJqy"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_ygLL"><div class="docItemContainer_yJzi"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_nmcO" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/en/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/en/docs/translation"><span itemprop="name">翻译</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">Lua的垃圾回收</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_aX8Q theme-doc-toc-mobile tocMobile_By44"><button type="button" class="clean-btn tocCollapsibleButton_Va7b">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Garbage Collection in Lua - Roberto Ierusalimschy</h1><blockquote><p><a href="https://www.youtube.com/watch?v=wGizKsOJQuE" target="_blank" rel="noopener noreferrer">Youtube视频地址</a></p></blockquote><blockquote><p><a href="https://www.lua.org/wshop18/Ierusalimschy.pdf" target="_blank" rel="noopener noreferrer">Slide幻灯片地址</a></p></blockquote><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="automatic-memory-management">Automatic Memory Management<a class="hash-link" href="#automatic-memory-management" title="Direct link to heading">​</a></h2><ul><li>Releases memory automatically, when it is not needed anymore.</li><li>Two main approaches:<ul><li>Reference counting</li><li>Garbage collection</li></ul></li><li>Lua uses garbage collection.<ul><li>main reason: in dynamically-typed languages, reference count adds overhead
even if a program never allocates memory.</li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="自动内存管理">自动内存管理<a class="hash-link" href="#自动内存管理" title="Direct link to heading">​</a></h3><ul><li>当对象不再需要时, 自动释放掉对象占用的内存.</li><li>目前市面上有两种主流方法实现用以自动内存管理:<ul><li>引用计数</li><li>垃圾回收</li></ul></li><li>其中 <code>Lua</code> 使用垃圾回收.</li><li>主要原因: 在动态类型语言中, 即使程序从不分配内存, 引用计数也会增加开销.</li></ul><p>因为在动态类型的语言中你不知道变量的类型, 没有类型引用计数会增加开销, 即使程序从不分配内存.</p><p>即使简单的操作数字或仅操作已分配但未创建新分配值的分配值, 您仍会不断更新引用计数, 这是一个很大的开销, 因此 <code>Lua</code>不使用引用计数.</p><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="the-lua-gc">The Lua GC<a class="hash-link" href="#the-lua-gc" title="Direct link to heading">​</a></h2><ul><li>All objects in Lua are subject to garbage collection.<ul><li>table, functions, &quot;modules&quot;, threads(coroutines) etc,</li></ul></li><li>Only objects accessible from the root set are preserved.<ul><li>root set: the registry and shared metatables.</li><li>the registry contains the global table (_G), the main thread, and
package.loaded.</li></ul></li><li>The collector operates on top of standard allocation functions.</li><li>All objects linked in a long list.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="lua的垃圾回收">Lua的垃圾回收<a class="hash-link" href="#lua的垃圾回收" title="Direct link to heading">​</a></h3><ul><li><code>Lua</code> 中的所有对象都需要进行垃圾回收.<ul><li>表, 函数, &quot;模块&quot;, 线程(协程)等,</li></ul></li><li>仅保留从<code>root set</code>中可访问的对象.<ul><li><code>root set</code>: <code>registry</code>和共享元表.</li><li><code>registry</code>包含全局表 (<code>_G</code>), 主线程和<code>package.loaded</code>.</li></ul></li><li>收集器操作在标准的分配函数之上进行.</li><li>所有对象都链接到一个<code>long list</code>中.</li></ul><p><code>Lua</code> 理解为一个大的生态系统, 当出现许多垃圾的时候, 进行自动回收之后确保生态系统能回到最初的状态.</p><p>共享元表: 在<code>Lua</code>是奇怪的类型, 比如函数编号, 除了表以外的所有东西和userdata都是共享的.
<code>standard allocation functions</code>: 例如来自标准C库的<code>malloc</code>, <code>realloc</code>, <code>free</code>, <code>calloc</code>
等.</p><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="lua-gc-until-version-50">Lua GC until Version 5.0<a class="hash-link" href="#lua-gc-until-version-50" title="Direct link to heading">​</a></h2><ul><li>Basic mark &amp; sweep collector.</li><li>Mark: traverse the object graph, starting from the root set, marking the live
objects.</li><li>Sweep: traverse the long list of all objects, deleting those not marked.</li><li>Between mark and sweep, the collector separates and resurrects objects to be
finalized.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="lua-在-50-之前的垃圾回收"><code>Lua</code> 在 5.0 之前的垃圾回收<a class="hash-link" href="#lua-在-50-之前的垃圾回收" title="Direct link to heading">​</a></h3><ul><li>基础的 <code>Mark &amp; Sweep</code> 收集器.</li><li>标记：遍历对象图, 从<code>root set</code>开始, 标记活对象.</li><li>清除：遍历所有对象的<code>long list</code>, 删除那些没有标记的.</li><li>在标记和清除过程中, 收集器分离并恢复需要执行<code>finalized</code>的对象.</li></ul><p>以上步骤基本都是原子性的.</p><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="the-collectors-pace">The Collector&#x27;s Pace<a class="hash-link" href="#the-collectors-pace" title="Direct link to heading">​</a></h2><ul><li>The pace of a collector is a key component in system&#x27;s performance.</li><li>A collector that never runs has zero CPU cost, but a huge memory cost.</li><li>A collector that runs at all the time has zero memory overhead, but a huge CPU
cost.</li><li>The sweet spot is somewhere in between.<ul><li>New Collection when memory use is twice the use at the end of last
collection.</li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="收集器的节奏">收集器的节奏<a class="hash-link" href="#收集器的节奏" title="Direct link to heading">​</a></h3><ul><li>收集器的节奏是系统性能的关键组成部分.</li><li>如果一个从来都不运行的收集器, 那么其 <code>CPU</code> 成本为零, 但对内存则是巨大的成本.</li><li>而如果一个一直运行的收集器, 那么其内存开销为零, 但 <code>CPU</code> 开销巨大.</li><li>那么平衡点则介于两者之间.<ul><li>当内存使用达到上次垃圾回收结束时的两倍时进行垃圾回收触发一次新的垃圾回收.</li></ul></li></ul><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="lua-gc-until-version-50defect">Lua GC until Version 5.0(defect)<a class="hash-link" href="#lua-gc-until-version-50defect" title="Direct link to heading">​</a></h2><ul><li>Main drawback of Mark &amp; Sweep: pauses in the program execution during a GC
cycle can be very long.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="lua-在-50-之前的垃圾回收缺点"><code>Lua</code> 在 5.0 之前的垃圾回收(缺点)<a class="hash-link" href="#lua-在-50-之前的垃圾回收缺点" title="Direct link to heading">​</a></h3><ul><li><code>Mark &amp; Sweep</code> 的主要缺点：在 <code>GC</code> 周期中程序执行的暂停可能会很长.</li></ul><p>也就是人们称之为的<code>stop the world</code>.</p><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="51">5.1<a class="hash-link" href="#51" title="Direct link to heading">​</a></h2><p>In version 5.1, Lua got an incremental collector. An <em>incremental</em> collector
interleaves the execution of the collector with the main program.</p><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="51-1">5.1<a class="hash-link" href="#51-1" title="Direct link to heading">​</a></h3><p>在5.1版中, 采用了增量垃圾回收策略.增量垃圾回收器的垃圾回收可以逐步进行, 不需要一次性完成, 避免了对程序的长时间暂停.</p><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="the-mutator">The mutator<a class="hash-link" href="#the-mutator" title="Direct link to heading">​</a></h2><ul><li>From the garbage collector&#x27;s point of view, the program is just some nuisance
changing the data it is trying to collect: the mutator!</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="the-mutator不稳定因素">The mutator(不稳定因素)<a class="hash-link" href="#the-mutator不稳定因素" title="Direct link to heading">​</a></h3><ul><li>从垃圾回收器的角度来看, 程序自身就是一个噪音源时常改变数据导致垃圾回收操作!</li></ul><p>促使垃圾回收进行的元凶, 也就是程序本身</p><p>理解为收集器的传入的变量</p><p>在垃圾回收的文献当中就有一个比较奇怪的术语, <code>mutator</code>, 也称主程序就是这个 <code>mutator</code> 的. 起始可以理解为 <code>mutator</code>
只是一个噪音而已, 亦可理解为不规范编写代码的程序就是一个不可估计的异端.</p><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="tri-color-collector">Tri-color Collector<a class="hash-link" href="#tri-color-collector" title="Direct link to heading">​</a></h2><ul><li>Each object is in one of three states: white, gray, or black.</li><li>Non-visited objects are marked white.</li><li>Visited but not-traversed objects are marked gray.</li><li>Traversed objects are marked black.</li></ul><p><img loading="lazy" src="https://pic1.zhimg.com/v2-9a19f9bc005eb4561d827b7b385670e4_b.jpg" alt="图片" class="img_PFMr"></p><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="三色收集器">三色收集器<a class="hash-link" href="#三色收集器" title="Direct link to heading">​</a></h3><ul><li>每个物体都处于三种状态之一：白色、灰色或黑色.</li><li>未访问的对象被标记为白色.</li><li>已访问但未经过的对象标记为灰色.</li><li>被遍历的对象被标记为黑色.</li></ul><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="invariants">Invariants<a class="hash-link" href="#invariants" title="Direct link to heading">​</a></h2><ul><li>Objects in the root set are gray or black.</li><li>A black object cannot point to a white object.</li><li>Gray objects define the boundary between the black objects and the white
objects.</li><li>Collection advances by traversing gray objects, turning them black.<ul><li>which may create new gray objects</li></ul></li><li>Collection ends when there are no more gray objects.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="定义不变量">定义(不变量)<a class="hash-link" href="#定义不变量" title="Direct link to heading">​</a></h3><ul><li><code>root set</code>中的对象要么为灰色, 要么为黑色.</li><li>黑色的对象不会指向白色对象.</li><li>灰色对象定义黑色对象和白色对象之间的边界.</li><li>收集过程通过不断地遍历灰色对象, 将其变为黑色.<ul><li>这可能会产生新的灰色物体</li></ul></li><li>当不再有灰色对象时, 收集步骤结束.</li></ul><p>同时灰色存在的那一圈被理解为一个边界.</p><p>最终将会没有灰色, 黑色将会被保留, 白色被当作垃圾作为清除.</p><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="barriers">Barriers<a class="hash-link" href="#barriers" title="Direct link to heading">​</a></h2><ul><li>The mutator can break the invariant of black objects not pointing to white
ones.
<code>t.x = {}</code></li><li>A <em>write barrier</em> tests this case and restores the invariant if necessary.<ul><li>slows down all assignments.</li></ul></li><li>It can either move forward the white object to gray or move backward the black
object to gray.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="屏障">屏障<a class="hash-link" href="#屏障" title="Direct link to heading">​</a></h3><ul><li><code>The mutator(不稳定因素)</code>可以打破黑色物体不指向白色物体的<code>invariant(定义)</code>.<ul><li>例如这么编写的代码: <code>t.x = {}</code></li></ul></li><li>写屏障检测到这种情况时, 并在必要时确保<code>invariant(定义)</code>不会被推翻(恢复不变量).<ul><li>但这样做使得所有赋值操作变慢.</li></ul></li><li>屏障将白色对象推进到灰色, 也可以将黑色对象回退到灰色.</li></ul><p>上面的 <code>t</code> 理解为黑色对象, <code>{}</code> 理解为一个新的白色对象, 理论上是不存在, 黑色直接指向白色的. 所以这里就打破了屏障.</p><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="some-heuristics">Some Heuristics<a class="hash-link" href="#some-heuristics" title="Direct link to heading">​</a></h2><ul><li>Objects moved back to gray are kept in a separate list to be traversed only in
the atomic phase.<ul><li>avoids a ping-pong</li></ul></li><li>Stacks are kept gray.<ul><li>avoids barriers when writing to the stack!</li></ul></li><li>Assignment to tables moves a black table back to gray.
<code>for i = 1, N do a[i] = &lt;exp&gt; end</code></li><li>Assignment of a metatable moves a white metatable forward to gray.
<code>setmetatable(obj, mt)</code></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="启发式处理">启发式处理<a class="hash-link" href="#启发式处理" title="Direct link to heading">​</a></h3><ul><li>移回的灰色对象被保存在一个单独列表中, 并在之后的原子阶段才能遍历.<ul><li>避免对象状态的反复变更</li></ul></li><li>让栈中的对象保持灰色.<ul><li>避免写入栈时屏障生效.</li></ul></li><li>对表进行赋值时将状态为黑色的表变为状态为灰色.
<code>for i = 1, N do a[i] = &lt;exp&gt; end</code></li><li>对元表进行赋值时将状态为白色的元表变为状态为灰色.
<code>setmetatable(obj, mt)</code></li></ul><p>这里的写入栈通常是写入局部变量参数, 代价就是在原子阶段也需要遍历栈.</p><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="the-atomic-step">The Atomic Step<a class="hash-link" href="#the-atomic-step" title="Direct link to heading">​</a></h2><ul><li>The mark phase is ended by an atomic step.</li><li>This step traverses all &quot;gray again&quot; objects.<ul><li>including stacks</li></ul></li><li>It clears weak tables.</li><li>It separates objects to be finalized, resurrecting them and their graphs.</li><li>It clears weak tables (again?).</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="原子阶段">原子阶段<a class="hash-link" href="#原子阶段" title="Direct link to heading">​</a></h3><ul><li>增量标记操作结束后进入一个原子阶段.</li><li>原子阶段遍历我们之前维护在一个独立的表中的所有&quot;再次变为灰色&quot;的对象.<ul><li>包括栈上的对象.</li></ul></li><li>清除弱引用的表.</li><li>分离, 并恢复需要执行<code>finalize</code>操作的对象.</li><li>再次清除弱引用的表.</li></ul><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="the-incremental-collectors-pace">The Incremental Collector&#x27;s Pace<a class="hash-link" href="#the-incremental-collectors-pace" title="Direct link to heading">​</a></h2><ul><li>An incremental collector runs alternated with the mutator.</li><li>At what pace?</li><li>Most collectors measure &quot;time&quot; by memory allocation.</li><li>How to translate bytes to GC activity?<ul><li>the fallacy of &quot;big userdata&quot;</li></ul></li><li>Two variables control the pace of the incremental collector.</li><li>The pause controls by how much memory has to grow before starting a new cycle.<ul><li>the fixed &quot;2&quot; in the old scheme.</li></ul></li><li>The multiplier controls the translation of bytes to GC work.<ul><li>still somewhat mystifying</li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="增量收集器的节奏">增量收集器的节奏<a class="hash-link" href="#增量收集器的节奏" title="Direct link to heading">​</a></h3><ul><li>增量收集器与<code>mutator(不稳定因素)</code>交替运行.</li><li>以怎样的节奏进行呢?</li><li>大多数收集器通过内存分配来把握&quot;时间&quot;.</li><li>所以我们是以哪种方式来告诉收集器需要开始运行的呢?<ul><li>通常大多数人理解的<em>大的用户数据</em>, 这其实是谬论.</li></ul></li><li>两个变量控制增量收集器的速度.</li><li><code>pause(暂停)</code>控制着在开始一个新的循环之前必须增加多少内存.<ul><li>旧方案中的固定&quot;2&quot;.</li></ul></li><li><code>multiplier(乘数)</code>控制垃圾回收的工作频率.<ul><li>还是有点神秘</li></ul></li></ul><p>有一个称为<code>multiplier(乘数)</code>的模型, 用以调整其频率. 另一个是<code>pause(暂停)</code>的模型, 可以获取更大的暂停.</p><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="summary">Summary<a class="hash-link" href="#summary" title="Direct link to heading">​</a></h2><p>An incremental collector reduces the length of pauses, but it does not reduce
the overall overhead of the collector; quite the opposite.</p><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="小结">小结<a class="hash-link" href="#小结" title="Direct link to heading">​</a></h3><p>增量垃圾回收虽然减少了程序每次暂停的时间, 但垃圾回收操作的总时间代价和之前相比并没有减少.</p><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="the-generational-collector">The Generational Collector<a class="hash-link" href="#the-generational-collector" title="Direct link to heading">​</a></h2><ul><li>The generational hypothesis: most objects die young.</li><li>So, the collector could concentrate its efforts in young objects.</li><li>All objects are classified as young or old. They are young when created; after
surviving two collections, they become old.</li><li>In a minor collection, the collector traverses and sweeps only young objects.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="分代垃圾回收器">分代垃圾回收器<a class="hash-link" href="#分代垃圾回收器" title="Direct link to heading">​</a></h3><ul><li>分代假设: 大多数对象很快失活.</li><li>因此, 收集器可以把精力集中在新对象上.</li><li>所有对象都分为新旧分类. 他们被创造出来时被认为是新的；在保存了两代后, 对象变旧.</li><li>在<code>minor(小)</code>集合中, 收集器只遍历和清除新对象.</li></ul><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="the-generational-invariant">The Generational Invariant<a class="hash-link" href="#the-generational-invariant" title="Direct link to heading">​</a></h2><ul><li>An old object should not point to a new one.</li><li>Not so easy to keep as the incremental invariant.</li><li>Both moving &quot;forward&quot; or &quot;backward&quot; have their problems.<ul><li>forward: creates too many old objects (and breaks invariant)</li><li>backward: breaks invariant somewhere else</li></ul></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="分代的定义">分代的定义<a class="hash-link" href="#分代的定义" title="Direct link to heading">​</a></h3><ul><li>旧对象不应指向新对象.</li><li>不像增量<code>invriant(定义)</code>那么容易保持.</li><li>&quot;推进&quot;或&quot;回退&quot;都有问题.<ul><li>推进: 创建太多的旧对象（并破坏<code>invriant(定义)</code>）</li><li>回退: 同样会修改其<code>invriant(定义)</code></li></ul></li></ul><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="the-touched-objects">The Touched Objects<a class="hash-link" href="#the-touched-objects" title="Direct link to heading">​</a></h2><ul><li>If a back barrier detects an old object pointing to a new one, the old object
is marked as touched and put in a special list.<ul><li>not totally unlike the gray-again list</li></ul></li><li>Touched objects are also traversed (but not collected) in minor collections.</li><li>After two cycles, a touched object goes back to regular old, unless it is
touched again.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="被触摸的对象">被触摸的对象<a class="hash-link" href="#被触摸的对象" title="Direct link to heading">​</a></h3><ul><li>如果回退屏障检测到旧对象指向了新对象, 旧物体将被标记为已触摸, 并放入特殊列表中.<ul><li>和<code>(gray again)再次灰色列表</code>没什么两样</li></ul></li><li>触摸的对象也会在<code>minor(小)</code>集合中遍历（但不会被收集）.</li><li>经过两次循环后, 一个触摸的物体会回到原来的状态, 除非它再次被触摸.</li></ul><p><img loading="lazy" src="https://pic1.zhimg.com/v2-535211242d20aec0b7a3bbbbbc33e220_b.jpg" class="img_PFMr"></p><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="questions">Questions<a class="hash-link" href="#questions" title="Direct link to heading">​</a></h2><p>What was wrong with the generational collector in Lua 5.2?</p><p>Objects had to survive one GC cycle before becoming old.</p><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="提问">提问<a class="hash-link" href="#提问" title="Direct link to heading">​</a></h3><ul><li><p>Lua 5.2的分代垃圾回收器的错误之处是？</p></li><li><p>新对象只经历一次垃圾回收就变旧.</p></li></ul><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="surviving-one-cycle">Surviving One Cycle<a class="hash-link" href="#surviving-one-cycle" title="Direct link to heading">​</a></h2><ul><li>Much simpler implementation.</li><li>After a collection, all surviving objects become old, so the changes cannot
break the invariant.</li><li>List of touched objects can be erased.</li></ul><p><img loading="lazy" src="https://pic2.zhimg.com/v2-aac53cec9f897e7cd48d8cda0b2a56e5_b.jpg" class="img_PFMr"></p><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="存活一个周期">存活一个周期<a class="hash-link" href="#存活一个周期" title="Direct link to heading">​</a></h3><ul><li>实现起来比较简单.</li><li>收集之后, 所有幸存的对象都会变老, 因此更改不会破坏<code>invriant(定义)</code>.</li><li>触摸对象的列表可以删除.</li></ul><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="surviving-two-cycles">Surviving Two Cycles<a class="hash-link" href="#surviving-two-cycles" title="Direct link to heading">​</a></h2><ul><li>At the end of a collection, some new objects become old, some do not.<ul><li>breaks the invariant!</li></ul></li><li>List of touched objects must be corrected to next cycle.</li></ul><p><img loading="lazy" src="https://pic2.zhimg.com/v2-0eeb588f9817a55345e81beebdb1d5a9_b.jpg" class="img_PFMr"></p><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="存活两个周期">存活两个周期<a class="hash-link" href="#存活两个周期" title="Direct link to heading">​</a></h3><ul><li>在一个收集之后, 一些新对象变为旧对象, 一些则不变.<ul><li>打破了<code>invriant(定义)</code></li></ul></li><li>触摸对象的列表必须更正到下一个周期.</li></ul><hr><h2 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="final-remarks">Final Remarks<a class="hash-link" href="#final-remarks" title="Direct link to heading">​</a></h2><ul><li>When the generational hypothesis holds, a generational collector can reduce
the overhead of the GC.</li><li>Not always the hypothesis holds.<ul><li>batch programs</li></ul></li><li>Testing a collector is hard.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_c5FC" id="总结">总结<a class="hash-link" href="#总结" title="Direct link to heading">​</a></h3><ul><li>如果分代的假设成立, 分代垃圾回收器可以减少垃圾回收的代价.</li><li>这个假设并不总是成立的.<ul><li>仅仅是对于批处理脚本来说很多时候这个假设就不成立</li></ul></li><li>对于垃圾回收器的好坏评估较为困难.</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/danyow/danyow.github.io/edit/main/docs/translation/luagc.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_OMbO" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vA0S"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-04-16T17:35:11.000Z">4/16/2022</time></b> by <b>danyow</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/en/docs/translation/boehm"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Boehm垃圾回收</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_jWtb thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#automatic-memory-management" class="table-of-contents__link toc-highlight">Automatic Memory Management</a><ul><li><a href="#自动内存管理" class="table-of-contents__link toc-highlight">自动内存管理</a></li></ul></li><li><a href="#the-lua-gc" class="table-of-contents__link toc-highlight">The Lua GC</a><ul><li><a href="#lua的垃圾回收" class="table-of-contents__link toc-highlight">Lua的垃圾回收</a></li></ul></li><li><a href="#lua-gc-until-version-50" class="table-of-contents__link toc-highlight">Lua GC until Version 5.0</a><ul><li><a href="#lua-在-50-之前的垃圾回收" class="table-of-contents__link toc-highlight"><code>Lua</code> 在 5.0 之前的垃圾回收</a></li></ul></li><li><a href="#the-collectors-pace" class="table-of-contents__link toc-highlight">The Collector&#39;s Pace</a><ul><li><a href="#收集器的节奏" class="table-of-contents__link toc-highlight">收集器的节奏</a></li></ul></li><li><a href="#lua-gc-until-version-50defect" class="table-of-contents__link toc-highlight">Lua GC until Version 5.0(defect)</a><ul><li><a href="#lua-在-50-之前的垃圾回收缺点" class="table-of-contents__link toc-highlight"><code>Lua</code> 在 5.0 之前的垃圾回收(缺点)</a></li></ul></li><li><a href="#51" class="table-of-contents__link toc-highlight">5.1</a><ul><li><a href="#51-1" class="table-of-contents__link toc-highlight">5.1</a></li></ul></li><li><a href="#the-mutator" class="table-of-contents__link toc-highlight">The mutator</a><ul><li><a href="#the-mutator不稳定因素" class="table-of-contents__link toc-highlight">The mutator(不稳定因素)</a></li></ul></li><li><a href="#tri-color-collector" class="table-of-contents__link toc-highlight">Tri-color Collector</a><ul><li><a href="#三色收集器" class="table-of-contents__link toc-highlight">三色收集器</a></li></ul></li><li><a href="#invariants" class="table-of-contents__link toc-highlight">Invariants</a><ul><li><a href="#定义不变量" class="table-of-contents__link toc-highlight">定义(不变量)</a></li></ul></li><li><a href="#barriers" class="table-of-contents__link toc-highlight">Barriers</a><ul><li><a href="#屏障" class="table-of-contents__link toc-highlight">屏障</a></li></ul></li><li><a href="#some-heuristics" class="table-of-contents__link toc-highlight">Some Heuristics</a><ul><li><a href="#启发式处理" class="table-of-contents__link toc-highlight">启发式处理</a></li></ul></li><li><a href="#the-atomic-step" class="table-of-contents__link toc-highlight">The Atomic Step</a><ul><li><a href="#原子阶段" class="table-of-contents__link toc-highlight">原子阶段</a></li></ul></li><li><a href="#the-incremental-collectors-pace" class="table-of-contents__link toc-highlight">The Incremental Collector&#39;s Pace</a><ul><li><a href="#增量收集器的节奏" class="table-of-contents__link toc-highlight">增量收集器的节奏</a></li></ul></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a><ul><li><a href="#小结" class="table-of-contents__link toc-highlight">小结</a></li></ul></li><li><a href="#the-generational-collector" class="table-of-contents__link toc-highlight">The Generational Collector</a><ul><li><a href="#分代垃圾回收器" class="table-of-contents__link toc-highlight">分代垃圾回收器</a></li></ul></li><li><a href="#the-generational-invariant" class="table-of-contents__link toc-highlight">The Generational Invariant</a><ul><li><a href="#分代的定义" class="table-of-contents__link toc-highlight">分代的定义</a></li></ul></li><li><a href="#the-touched-objects" class="table-of-contents__link toc-highlight">The Touched Objects</a><ul><li><a href="#被触摸的对象" class="table-of-contents__link toc-highlight">被触摸的对象</a></li></ul></li><li><a href="#questions" class="table-of-contents__link toc-highlight">Questions</a><ul><li><a href="#提问" class="table-of-contents__link toc-highlight">提问</a></li></ul></li><li><a href="#surviving-one-cycle" class="table-of-contents__link toc-highlight">Surviving One Cycle</a><ul><li><a href="#存活一个周期" class="table-of-contents__link toc-highlight">存活一个周期</a></li></ul></li><li><a href="#surviving-two-cycles" class="table-of-contents__link toc-highlight">Surviving Two Cycles</a><ul><li><a href="#存活两个周期" class="table-of-contents__link toc-highlight">存活两个周期</a></li></ul></li><li><a href="#final-remarks" class="table-of-contents__link toc-highlight">Final Remarks</a><ul><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/en/assets/js/runtime~main.ff5b954a.js"></script>
<script src="/en/assets/js/main.7d9fb09f.js"></script>
</body>
</html>